# black-scholes公式推导
模型假设：         
1. The spot price $S_t$ follows lognormal process , driven by constant volatility $\sigma$.     
2. Short selling is permissible.    
3. No transaction costs or taxes.    
4. risk-free rates $r$ , constant across all maturities.         
5. No riskless arbitrage.      
6. Trading is continuous between now $(t=0)$ and expiry $(t=T)$.

伊藤引理：定义伊藤过程 $X_t$ 为满足下列随机微分方程的随机过程   
$$d X_t=\mu_t d t+\sigma_t d W_t$$  

对于伊藤过程 $X_t$ 和二次可导函数 $f(t, x)$ ，以下等式成立:   
$$d f\left(t, X_t\right)=\left(\frac{\partial f}{\partial t}+\mu_t \frac{\partial f}{\partial x}+\frac{1}{2} \sigma_t^2 \frac{\partial^2 f}{\partial x^2}\right) d t+\sigma_t \frac{\partial f}{\partial x} d W_t$$   

标的物的价格： $$d S_t=\mu S_t d t+\sigma S_t d W_t$$      
股价解析式推导：    
$$d(\ln S_t) = \frac{1}{S_t} d S_t - \frac{1}{2 S^2_t} (d S_t)^2$$
$$d(\ln S_t) = \left(\mu-\frac{\sigma^2}{2}\right) d t+\sigma d W_t$$
$$S_T = S_t \exp \left(\left(\mu-\frac{\sigma^2}{2}\right) (T-t)+\sigma (W(T) - W(t))\right)$$
注： $\mu$ :股票的年收益率期望; $\mu-\frac{\sigma^2}{2}$ :股票每年的连续复利期望收益率     

期权定价（欧式看涨期权C为例）:     
$$C=C(S_t,t)$$
由伊藤引理：   
$$d C=\frac{\partial C}{\partial t} d t + \frac{\partial C}{\partial S_t} d S_t + \frac{\partial^2 C}{2 \partial S^2_t} (d S_t)^2$$
$$d C=\left(\frac{\partial C}{\partial S_t} \mu S_t+\frac{\partial C}{\partial t}+\frac{1}{2} \frac{\partial^2 C}{\partial S_t^2} \sigma^2 S_t^2\right) d t+\frac{\partial C}{\partial S_t} \sigma S_t d W_t$$
构建Delta 对冲（做空 1 份期权，并做多 $\partial C / \partial S_t$ 份股票），并且用P表示该投资组合价值
$$d P = - d C + \frac{\partial C}{\partial S_t} d S_t$$
$$d P = \left(-\frac{\partial C}{\partial t}-\frac{1}{2} \frac{\partial^2 C}{\partial S^2_t} \sigma^2 S^2_t\right) d t$$
在不存在无风险套利的市场中，该投资组合在 $d t$ 内的收益率必须等于无风险收益率 $r$ ，即 $d P=r P d t$ 
$$\left(-\frac{\partial C}{\partial t}-\frac{1}{2} \frac{\partial^2 C}{\partial S^2_t} \sigma^2 S^2_t\right) d t = r(-C + \frac{\partial C}{\partial S_t} S_t) d t$$
$$\frac{\partial C}{\partial t} + r S_t\frac{\partial C}{\partial S_t}  + \frac{1}{2} \sigma^2 S^2_t \frac{\partial^2 C}{\partial S^2_t} = rC$$
由此得到Black-Scholes 微分方程      
求解该方程还需一个边界条件——当时间 $t=T$ (行权时刻) 时，期权的价格 $C$ 必须满足 $C=\max (S(T)-K, 0)$ ，K 是行权价格。     

$\mu$ :风险态度,投资者对风险的厌恶程度越高，对任何股票，相应的 $\mu$ 也会越高；由于Black-Scholes 微分方程不体现风险偏好，所以我们可以假设假设所有的投资者都是风险中性的。              
风险中性定价理论（Risk-neutral valuation）：所有的资产（不管风险如何）都要求相同的收益率（无风险收益率），而且，所有资产的均衡定价都可以按照风险中性概率算出来未来收益的预期值，在以无风险利率折现得到。      

定价过程：     
1. 假定标的资产的收益率期望为无风险利率（即假定 $\mu=r$ ）        
2. 计算衍生产品到期时收益的期望；      
3. 用无风险利率 $r$ 对衍生品收益期望进行贴现。        
在风险中性定价理论下， $S$ 的期望收益率为无风险收益率 $r$ ，且期权的折现率也等于无风险收益率 $r$ 。因此，期权在当前时刻的价格 $C$ 为:
$$C=e^{-r T} \mathrm{E}\[\max (S(T)-K, 0)\]$$
$$C=e^{-r T} \mathrm{E}\[(S(T)-K) \mathbf{1}_ {S(T) \geq K}\]$$
$$C=e^{-r T} \mathrm{E}\[S(T) \mathbf{1}_ {S(T) \geq K}\] - e^{-r T} K \mathrm{P}(S(T) \geq K)$$
$$\mathrm{P}(S(T) \geq K) = N(\frac{\ln (S_0 / K)+\left(r-\sigma^2 / 2\right) T}{\sigma \sqrt{T}})$$
$$e^{-r T} \mathrm{E}\[S(T) \mathbf{1}_{S(T) \geq K}\] = e^{-r T} \mathrm{E}\[S_0 e^ {\left(\left(r-\frac{\sigma^2}{2}\right) T+\sigma W(T)\right)} \mathbf{1} _{S(T) \geq K}\]$$
$$e^{-r T} \mathrm{E}\[S(T) \mathbf{1} _{S(T) \geq K}\] = S_0 N(\frac{\ln (S_0 / K)+\left(r+\sigma^2 / 2\right) T}{\sigma \sqrt{T}})$$
综上：   
$$C =S_0 N\left(d_1\right)-K e^{-r T} N\left(d_2\right)$$ 
$$P =K e^{-r T} N\left(-d_2\right)-S_0 N\left(-d_1\right)$$ 
$$\text { where } \quad d_1 =\frac{\ln (S_0 / K)+\left(r+\sigma^2 / 2\right) T}{\sigma \sqrt{T}}$$
$$d_2 =\frac{\ln (S_0 / K)+\left(r-\sigma^2 / 2\right) T}{\sigma \sqrt{T}}=d_1-\sigma \sqrt{T}$$

# black-76公式推导
现货期权的标的资产是现货，期货期权的标的资产是期货，持有现货往往需要百分之百的资金，持有期货只需要很少一个比例的保证金。由于相同条件下的现货持有成本高于期货持有成本，因此相同条件下的现货认买期权价格要略高于期货认买期权价格，而现货认卖期权价格要略低于期货认卖期权价格。     

假定期货价格遵循如下过程：
$$d F=\mu_F F d t+\sigma F d W_t$$
构建Delta 对冲（做空 1 份期权，并做多 $\partial C / \partial F$ 份期货合约），并且用P表示该投资组合价值( $P = -C + \frac{\partial C}{\partial F} F$ )
$$d C=\left(\frac{\partial C}{\partial F} \mu F+\frac{\partial C}{\partial t}+\frac{1}{2} \frac{\partial^2 C}{\partial F^2} \sigma^2 F^2\right) d t+\frac{\partial C}{\partial F} \sigma F d W_t$$
Black F.认为期货合约构建成本为零
$$d P = -r C d t$$
由于不存在无风险套利，因此：
$$\frac{\partial C}{\partial t}+\frac{1}{2} \frac{\partial^2 C}{\partial F^2} \sigma^2 F^2 = r C$$






对于欧式看涨期货期权
